class DModifier {
    constructor() {
        this.token = null;
        this.user = {};
    }

    addHook(callback) {
        this.id = Math.random().toString(36);
        window.webpackChunkdiscord_app.push([[this.id], {}, function(req) {
            let keyed = Object.keys(req.c).map(function(key) {
                if (req.c[key].exports) {
                    return req.c[key].exports
                }
            }).filter(function(e) {
                return e
            })

            callback.call(this, keyed)
        }])
    }

}

let Modifier = new DModifier();

Modifier.addHook(function(keyed) {
    keyed.find(function(key) {
        let def = key.default

        if (!def) return

        if (def.getToken !== undefined) {
            Modifier.token = def.getToken()
        }

        if (def.getCurrentUser !== undefined) {
            Object.assign(Modifier.user, def.getCurrentUser())
        }
    })
})

// testing

Modifier.addHook(function(keyed) {
    keyed.find(function(key) {
        let def = key.default

        if (!def) return

        let text = def.toString()
        // check for the word "message" in every text
        if (text.toLowerCase().includes("message")) {
            console.log("Found message")
            console.log(def.toString())
            console.log(def)
        }
    })
})